extends Node

var room_generation = RoomGeneration.new()

var room_name = "intro"

@export var intro_scenes: Array[PackedScene]

var moon = preload("res://objects/other/intro/moon/moon.tscn")
var intro_bg = preload("res://objects/other/intro/intro_bg/intro_bg.tscn")
var palm_tree_dark = preload("res://objects/other/intro/palm_tree_dark/palm_tree_dark.tscn")
var cave_bg2 = preload("res://objects/blocks/cave_bg2/cave_bg2.tscn")
var cave_bg_entrance = preload("res://objects/blocks/cave_bg_entrance/cave_bg_entrance.tscn")
var shrub_dark = preload("res://objects/other/intro/shrub_dark/shrub_dark.tscn")
var desert = preload("res://objects/other/intro/desert/desert.tscn")
var dark = preload("res://objects/blocks/dark/dark.tscn")
var desert2 = preload("res://objects/other/intro/desert2/desert2.tscn")
var desert_top = preload("res://objects/other/intro/desert_top/desert_top.tscn")
var intro = preload("res://objects/intro/intro.tscn")
var bricks = preload("res://objects/bricks/bricks.tscn")
var game = preload("res://objects/game/game.tscn")
var bat_intro = preload("res://objects/other/intro/bat_intro/bat_intro.tscn")

var scenes_with_id = {}
var tile_map = TileMap.new()
var layer = 0

var last_object = ''

# Called when the node enters the scene tree for the first time.
func _ready():
	room_generation.generate_room('intro')

	#tile_map.position.x = -8
	#tile_map.position.y = -8
	#var tile_set = TileSet.new()
	#tile_map.tile_set = tile_set
	#var tile_set_source = TileSetScenesCollectionSource.new()
	#tile_set.add_source(tile_set_source)
	#
	#var i = 0
	#
	#for scene in intro_scenes:
		#i += 1
		#tile_set_source.create_scene_tile(scene)
		#scenes_with_id[scene._bundled.names[2]] = i
	#
	#print(scenes_with_id)
	#
	#await get_tree().create_timer(2).timeout
	#add_child(tile_map)
	#tile_map.owner = get_tree().edited_scene_root
	#print("for test")
	#print(tile_set_source.get_tiles_count())
	#
	#var keys = scenes_with_id.keys()
	#var number_of_scenes = keys.size()
	#
	#for num in number_of_scenes:
		#tile_map.add_layer(num)
	#
	#
	#add_tile(208, 16, "moon")
	#add_tile(0, 112, "intro_bg")
	#add_tile(80, 64, "palm_tree_dark")
	#add_tile(224, 64, "palm_tree_dark")
	#add_tile(272, 64, "palm_tree_dark")
	#add_tile(416, 64, "palm_tree_dark")
	#add_tile(512, 64, "palm_tree_dark")
	#add_tile(640, 64, "palm_tree_dark")
	#add_tile(752, 144, "cave_bg2")
	#add_tile(720, 144, "cave_bg2")
	#add_tile(784, 144, "cave_bg2")
	#add_tile(816, 144, "cave_bg2")
	#add_tile(848, 144, "cave_bg2")
	#add_tile(880, 144, "cave_bg2")
	#add_tile(912, 144, "cave_bg2")
	#add_tile(720, 176, "cave_bg2")
	#add_tile(752, 176, "cave_bg2")
	#add_tile(784, 176, "cave_bg2")
	#add_tile(816, 176, "cave_bg2")
	#add_tile(848, 176, "cave_bg2")
	#add_tile(880, 176, "cave_bg2")
	#add_tile(912, 176, "cave_bg2")
	#add_tile(912, 208, "cave_bg2")
	#add_tile(704, 176, "cave_bg_entrance")
	#add_tile(192, 176, "shrub_dark")
	#add_tile(336, 176, "shrub_dark")
	#add_tile(384, 176, "shrub_dark")
	#add_tile(464, 176, "shrub_dark")
	#add_tile(560, 176, "shrub_dark")
	#add_tile(640, 176, "shrub_dark")
	#add_tile(672, 176, "shrub_dark")
	#add_tile(0, 224, "desert")
	#add_tile(16, 224, "desert")
	#add_tile(32, 224, "desert")
	#add_tile(48, 224, "desert")
	#add_tile(64, 224, "desert")
	#add_tile(48, 208, "desert")
	#add_tile(32, 208, "desert")
	#add_tile(16, 208, "desert")
	#add_tile(0, 208, "desert")
	#add_tile(224, 208, "desert")
	#add_tile(208, 208, "desert")
	#add_tile(192, 208, "desert")
	#add_tile(176, 208, "desert")
	#add_tile(160, 208, "desert")
	#add_tile(144, 208, "desert")
	#add_tile(128, 208, "desert")
	#add_tile(64, 208, "desert")
	#add_tile(80, 208, "desert")
	#add_tile(96, 208, "desert")
	#add_tile(112, 208, "desert")
	#add_tile(80, 224, "desert")
	#add_tile(96, 224, "desert")
	#add_tile(112, 224, "desert")
	#add_tile(128, 224, "desert")
	#add_tile(144, 224, "desert")
	#add_tile(160, 224, "desert")
	#add_tile(176, 224, "desert")
	#add_tile(192, 224, "desert")
	#add_tile(208, 224, "desert")
	#add_tile(432, 208, "desert")
	#add_tile(416, 208, "desert")
	#add_tile(400, 208, "desert")
	#add_tile(336, 208, "desert")
	#add_tile(320, 208, "desert")
	#add_tile(304, 208, "desert")
	#add_tile(288, 208, "desert")
	#add_tile(272, 208, "desert")
	#add_tile(240, 208, "desert")
	#add_tile(256, 208, "desert")
	#add_tile(384, 208, "desert")
	#add_tile(368, 208, "desert")
	#add_tile(352, 208, "desert")
	#add_tile(224, 224, "desert")
	#add_tile(240, 224, "desert")
	#add_tile(256, 224, "desert")
	#add_tile(272, 224, "desert")
	#add_tile(288, 224, "desert")
	#add_tile(304, 224, "desert")
	#add_tile(320, 224, "desert")
	#add_tile(336, 224, "desert")
	#add_tile(352, 224, "desert")
	#add_tile(368, 224, "desert")
	#add_tile(384, 224, "desert")
	#add_tile(400, 224, "desert")
	#add_tile(416, 224, "desert")
	#add_tile(624, 208, "desert")
	#add_tile(608, 208, "desert")
	#add_tile(592, 208, "desert")
	#add_tile(576, 208, "desert")
	#add_tile(560, 208, "desert")
	#add_tile(544, 208, "desert")
	#add_tile(528, 208, "desert")
	#add_tile(512, 208, "desert")
	#add_tile(496, 208, "desert")
	#add_tile(480, 208, "desert")
	#add_tile(464, 208, "desert")
	#add_tile(448, 208, "desert")
	#add_tile(432, 224, "desert")
	#add_tile(448, 224, "desert")
	#add_tile(464, 224, "desert")
	#add_tile(480, 224, "desert")
	#add_tile(496, 224, "desert")
	#add_tile(512, 224, "desert")
	#add_tile(528, 224, "desert")
	#add_tile(544, 224, "desert")
	#add_tile(560, 224, "desert")
	#add_tile(576, 224, "desert")
	#add_tile(592, 224, "desert")
	#add_tile(640, 208, "desert")
	#add_tile(656, 208, "desert")
	#add_tile(672, 208, "desert")
	#add_tile(608, 224, "desert")
	#add_tile(624, 224, "desert")
	#add_tile(640, 224, "desert")
	#add_tile(656, 224, "desert")
	#add_tile(672, 224, "desert")
	#add_tile(688, 224, "desert")
	#add_tile(704, 224, "desert")
	#add_tile(720, 224, "desert")
	#add_tile(944, 192, "dark")
	#add_tile(944, 208, "dark")
	#add_tile(944, 224, "dark")
	#add_tile(928, 224, "dark")
	#add_tile(928, 208, "dark")
	#add_tile(928, 144, "dark")
	#add_tile(944, 144, "dark")
	#add_tile(944, 160, "dark")
	#add_tile(944, 176, "dark")
	#add_tile(896, 192, "dark")
	#add_tile(896, 208, "dark")
	#add_tile(896, 224, "dark")
	#add_tile(880, 224, "dark")
	#add_tile(880, 208, "dark")
	#add_tile(864, 208, "dark")
	#add_tile(880, 192, "dark")
	#add_tile(864, 192, "dark")
	#add_tile(848, 192, "dark")
	#add_tile(832, 192, "dark")
	#add_tile(816, 192, "dark")
	#add_tile(800, 192, "dark")
	#add_tile(784, 192, "dark")
	#add_tile(736, 192, "dark")
	#add_tile(752, 192, "dark")
	#add_tile(768, 192, "dark")
	#add_tile(800, 208, "dark")
	#add_tile(816, 208, "dark")
	#add_tile(832, 208, "dark")
	#add_tile(848, 208, "dark")
	#add_tile(864, 224, "dark")
	#add_tile(848, 224, "dark")
	#add_tile(832, 224, "dark")
	#add_tile(816, 224, "dark")
	#add_tile(800, 224, "dark")
	#add_tile(768, 224, "dark")
	#add_tile(784, 224, "dark")
	#add_tile(784, 208, "dark")
	#add_tile(768, 208, "dark")
	#add_tile(752, 208, "dark")
	#add_tile(736, 208, "dark")
	#add_tile(720, 192, "dark")
	#add_tile(704, 192, "dark")
	#add_tile(688, 192, "dark")
	#add_tile(896, 128, "dark")
	#add_tile(880, 128, "dark")
	#add_tile(864, 128, "dark")
	#add_tile(848, 128, "dark")
	#add_tile(832, 128, "dark")
	#add_tile(816, 128, "dark")
	#add_tile(800, 128, "dark")
	#add_tile(784, 128, "dark")
	#add_tile(768, 128, "dark")
	#add_tile(752, 128, "dark")
	#add_tile(736, 128, "dark")
	#add_tile(720, 128, "dark")
	#add_tile(704, 128, "dark")
	#add_tile(688, 128, "dark")
	#add_tile(672, 128, "dark")
	#add_tile(640, 128, "dark")
	#add_tile(656, 128, "dark")
	#add_tile(656, 112, "dark")
	#add_tile(672, 112, "dark")
	#add_tile(688, 112, "dark")
	#add_tile(704, 112, "dark")
	#add_tile(720, 112, "dark")
	#add_tile(736, 112, "dark")
	#add_tile(752, 112, "dark")
	#add_tile(768, 112, "dark")
	#add_tile(784, 112, "dark")
	#add_tile(800, 112, "dark")
	#add_tile(816, 112, "dark")
	#add_tile(832, 112, "dark")
	#add_tile(848, 112, "dark")
	#add_tile(864, 112, "dark")
	#add_tile(880, 112, "dark")
	#add_tile(896, 112, "dark")
	#add_tile(896, 96, "dark")
	#add_tile(880, 96, "dark")
	#add_tile(864, 96, "dark")
	#add_tile(848, 96, "dark")
	#add_tile(832, 96, "dark")
	#add_tile(816, 96, "dark")
	#add_tile(800, 96, "dark")
	#add_tile(784, 96, "dark")
	#add_tile(768, 96, "dark")
	#add_tile(752, 96, "dark")
	#add_tile(736, 96, "dark")
	#add_tile(720, 96, "dark")
	#add_tile(704, 96, "dark")
	#add_tile(688, 96, "dark")
	#add_tile(688, 64, "dark")
	#add_tile(704, 64, "dark")
	#add_tile(704, 48, "dark")
	#add_tile(720, 48, "dark")
	#add_tile(736, 48, "dark")
	#add_tile(736, 80, "dark")
	#add_tile(688, 80, "dark")
	#add_tile(704, 80, "dark")
	#add_tile(720, 80, "dark")
	#add_tile(720, 64, "dark")
	#add_tile(736, 64, "dark")
	#add_tile(768, 64, "dark")
	#add_tile(816, 64, "dark")
	#add_tile(880, 80, "dark")
	#add_tile(848, 80, "dark")
	#add_tile(816, 80, "dark")
	#add_tile(800, 80, "dark")
	#add_tile(784, 80, "dark")
	#add_tile(768, 80, "dark")
	#add_tile(752, 80, "dark")
	#add_tile(752, 64, "dark")
	#add_tile(752, 0, "dark")
	#add_tile(736, 0, "dark")
	#add_tile(736, 16, "dark")
	#add_tile(736, 32, "dark")
	#add_tile(752, 48, "dark")
	#add_tile(752, 32, "dark")
	#add_tile(752, 16, "dark")
	#add_tile(768, 16, "dark")
	#add_tile(768, 0, "dark")
	#add_tile(784, 0, "dark")
	#add_tile(800, 0, "dark")
	#add_tile(800, 32, "dark")
	#add_tile(800, 48, "dark")
	#add_tile(800, 64, "dark")
	#add_tile(784, 64, "dark")
	#add_tile(784, 48, "dark")
	#add_tile(784, 16, "dark")
	#add_tile(768, 48, "dark")
	#add_tile(768, 32, "dark")
	#add_tile(784, 32, "dark")
	#add_tile(800, 16, "dark")
	#add_tile(832, 0, "dark")
	#add_tile(816, 48, "dark")
	#add_tile(816, 32, "dark")
	#add_tile(816, 16, "dark")
	#add_tile(816, 0, "dark")
	#add_tile(832, 16, "dark")
	#add_tile(832, 80, "dark")
	#add_tile(832, 64, "dark")
	#add_tile(832, 48, "dark")
	#add_tile(832, 32, "dark")
	#add_tile(848, 0, "dark")
	#add_tile(864, 80, "dark")
	#add_tile(864, 64, "dark")
	#add_tile(864, 48, "dark")
	#add_tile(864, 32, "dark")
	#add_tile(848, 64, "dark")
	#add_tile(848, 48, "dark")
	#add_tile(848, 32, "dark")
	#add_tile(848, 16, "dark")
	#add_tile(864, 16, "dark")
	#add_tile(864, 0, "dark")
	#add_tile(880, 0, "dark")
	#add_tile(880, 64, "dark")
	#add_tile(880, 48, "dark")
	#add_tile(880, 32, "dark")
	#add_tile(880, 16, "dark")
	#add_tile(896, 32, "dark")
	#add_tile(896, 16, "dark")
	#add_tile(896, 0, "dark")
	#add_tile(912, 0, "dark")
	#add_tile(912, 16, "dark")
	#add_tile(912, 128, "dark")
	#add_tile(928, 128, "dark")
	#add_tile(944, 128, "dark")
	#add_tile(944, 112, "dark")
	#add_tile(912, 112, "dark")
	#add_tile(928, 80, "dark")
	#add_tile(944, 96, "dark")
	#add_tile(928, 112, "dark")
	#add_tile(928, 96, "dark")
	#add_tile(912, 96, "dark")
	#add_tile(912, 80, "dark")
	#add_tile(896, 80, "dark")
	#add_tile(896, 64, "dark")
	#add_tile(896, 48, "dark")
	#add_tile(928, 48, "dark")
	#add_tile(928, 32, "dark")
	#add_tile(928, 0, "dark")
	#add_tile(928, 16, "dark")
	#add_tile(912, 32, "dark")
	#add_tile(912, 48, "dark")
	#add_tile(912, 64, "dark")
	#add_tile(928, 64, "dark")
	#add_tile(944, 80, "dark")
	#add_tile(944, 64, "dark")
	#add_tile(944, 48, "dark")
	#add_tile(944, 32, "dark")
	#add_tile(944, 16, "dark")
	#add_tile(944, 0, "dark")
	#add_tile(912, 144, "dark")
	#add_tile(928, 192, "dark")
	#add_tile(928, 160, "dark")
	#add_tile(928, 176, "dark")
	#add_tile(896, 144, "dark")
	#add_tile(672, 144, "dark")
	#add_tile(688, 144, "dark")
	#add_tile(704, 144, "dark")
	#add_tile(720, 144, "dark")
	#add_tile(736, 144, "dark")
	#add_tile(704, 160, "dark")
	#add_tile(688, 160, "dark")
	#add_tile(0, 192, "desert2")
	#add_tile(16, 192, "desert2")
	#add_tile(32, 192, "desert2")
	#add_tile(48, 192, "desert2")
	#add_tile(64, 192, "desert2")
	#add_tile(80, 192, "desert2")
	#add_tile(752, 224, "desert2")
	#add_tile(736, 224, "desert2")
	#add_tile(720, 208, "desert2")
	#add_tile(704, 208, "desert2")
	#add_tile(688, 208, "desert2")
	#add_tile(672, 192, "desert2")
	#add_tile(656, 192, "desert2")
	#add_tile(640, 192, "desert2")
	#add_tile(624, 192, "desert2")
	#add_tile(608, 192, "desert2")
	#add_tile(592, 192, "desert2")
	#add_tile(576, 192, "desert2")
	#add_tile(560, 192, "desert2")
	#add_tile(544, 192, "desert2")
	#add_tile(528, 192, "desert2")
	#add_tile(512, 192, "desert2")
	#add_tile(496, 192, "desert2")
	#add_tile(480, 192, "desert2")
	#add_tile(464, 192, "desert2")
	#add_tile(448, 192, "desert2")
	#add_tile(432, 192, "desert2")
	#add_tile(416, 192, "desert2")
	#add_tile(400, 192, "desert2")
	#add_tile(384, 192, "desert2")
	#add_tile(368, 192, "desert2")
	#add_tile(352, 192, "desert2")
	#add_tile(336, 192, "desert2")
	#add_tile(304, 192, "desert2")
	#add_tile(320, 192, "desert2")
	#add_tile(288, 192, "desert2")
	#add_tile(272, 192, "desert2")
	#add_tile(256, 192, "desert2")
	#add_tile(240, 192, "desert2")
	#add_tile(224, 192, "desert2")
	#add_tile(208, 192, "desert2")
	#add_tile(192, 192, "desert2")
	#add_tile(176, 192, "desert2")
	#add_tile(160, 192, "desert2")
	#add_tile(144, 192, "desert2")
	#add_tile(128, 192, "desert2")
	#add_tile(112, 192, "desert2")
	#add_tile(96, 192, "desert2")
	#add_tile(0, 176, "desert_top")
	#add_tile(16, 176, "desert_top")
	#add_tile(32, 176, "desert_top")
	#add_tile(48, 176, "desert_top")
	#add_tile(64, 176, "desert_top")
	#add_tile(80, 176, "desert_top")
	#add_tile(96, 176, "desert_top")
	#add_tile(112, 176, "desert_top")
	#add_tile(128, 176, "desert_top")
	#add_tile(144, 176, "desert_top")
	#add_tile(160, 176, "desert_top")
	#add_tile(176, 176, "desert_top")
	#add_tile(192, 176, "desert_top")
	#add_tile(208, 176, "desert_top")
	#add_tile(224, 176, "desert_top")
	#add_tile(240, 176, "desert_top")
	#add_tile(256, 176, "desert_top")
	#add_tile(272, 176, "desert_top")
	#add_tile(288, 176, "desert_top")
	#add_tile(304, 176, "desert_top")
	#add_tile(320, 176, "desert_top")
	#add_tile(336, 176, "desert_top")
	#add_tile(352, 176, "desert_top")
	#add_tile(384, 176, "desert_top")
	#add_tile(400, 176, "desert_top")
	#add_tile(416, 176, "desert_top")
	#add_tile(432, 176, "desert_top")
	#add_tile(448, 176, "desert_top")
	#add_tile(464, 176, "desert_top")
	#add_tile(480, 176, "desert_top")
	#add_tile(496, 176, "desert_top")
	#add_tile(512, 176, "desert_top")
	#add_tile(528, 176, "desert_top")
	#add_tile(544, 176, "desert_top")
	#add_tile(560, 176, "desert_top")
	#add_tile(576, 176, "desert_top")
	#add_tile(592, 176, "desert_top")
	#add_tile(608, 176, "desert_top")
	#add_tile(624, 176, "desert_top")
	#add_tile(640, 176, "desert_top")
	#add_tile(656, 176, "desert_top")
	#add_tile(672, 176, "desert_top")
	#add_tile(688, 192, "desert_top")
	#add_tile(704, 192, "desert_top")
	#add_tile(720, 192, "desert_top")
	#add_tile(736, 208, "desert_top")
	#add_tile(752, 208, "desert_top")
	#add_tile(688, 176, "desert_top")
	#add_tile(704, 176, "desert_top")
	#add_tile(368, 176, "desert_top")
	#add_tile(0, 0, "intro")
	#add_tile(16, 0, "bricks")
	##add_tile(32, 0, "globals")
	#add_tile(48, 0, "game")
	#add_tile(608, 144, "bat_intro")
	#add_tile(592, 128, "bat_intro")
	#add_tile(576, 160, "bat_intro")
	#add_tile(544, 144, "bat_intro")
#
	##$TileMap.create_scene_tile("res://objects/other/intro/moon/moon.tscn")
	##TileSetScenesCollectionSource
#
## Called every frame. 'delta' is the elapsed time since the previous frame.
#
#func add_tile(x, y, name):
	#var id = scenes_with_id[name]
	#var tile_x = 0
	#var tile_y = 0
	#
	#if x != 0:
		#tile_x = x / 16
	#if y!= 0:
		#tile_y = y / 16
		#
	#tile_map.set_cell(layer, Vector2i(tile_x, tile_y), 0, Vector2i(0, 0), id)
	#
	#if last_object != name:
		#last_object = name
		#layer += 1
	
func _process(delta):
	#print(gml.get_all_instances("rope"))
	pass
